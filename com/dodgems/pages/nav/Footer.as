package com.dodgems.pages.nav{	import com.gaiaframework.templates.AbstractPage;	import com.gaiaframework.events.*;	import com.gaiaframework.debug.*;	import com.gaiaframework.api.*;	import flash.display.*;	import flash.text.*;	import flash.events.*;	import flash.geom.Rectangle;	import flash.net.URLRequest;	import flash.net.URLLoader;	import flash.net.navigateToURL;	import com.greensock.TweenMax;	import com.greensock.easing.*;	//import com.dodgems.pages.nav.NavTxt;		import com.dodgems.Global;			public class Footer extends Sprite	{						public var bg:Sprite;				private var dataXML:XMLList;		private var xmlAsset:String = "xml/nav.xml";				private static const NAVWIDTH:Number = 960;		private static const NAVHEIGHT:Number = 45;		private static const NAVSPACER:Number = 20;		private static const SOCIAL_X:Number = 810;				private var leftContainer:Sprite;		private var socialContainer:Sprite;		private var navContainer:Sprite;		private var privacyBut:Sprite;		private var legalBut:Sprite;				private var leftSideBuilt:Boolean;				private var iconArr:Array = new Array();				private var currentLoadNum:int;		private var promoLoader:Loader = new Loader();		public function Footer(dat:XMLList)		{			dataXML = dat;			promoLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, finishLoading);			addEventListener(Event.ADDED_TO_STAGE, onAdded);					}								private function onAdded(e:Event){			createBG();			loadNav();		}						private function createBG(){			bg = new Sprite();			bg.graphics.beginFill(0x000000, 1);			bg.graphics.drawRect(0, 0, NAVWIDTH, NAVHEIGHT);			bg.graphics.endFill();			addChild(bg);						navContainer = new Sprite();			addChild(navContainer);						initLegal();		}				private function loadNav(){			var src:String;			if(currentLoadNum < dataXML.elements().length()){				src = dataXML.footerIcon[currentLoadNum].@asset							promoLoader.load(new URLRequest(src));			} 		}						private function finishLoading(e:Event)		{									var mc:MovieClip = new MovieClip();			mc.name = "nav"+currentLoadNum;						mc.x = (navContainer.width + NAVSPACER);			mc.y = 5;			mc.addChild(e.currentTarget.content);						navContainer.addChild(mc);												mc.addEventListener(MouseEvent.CLICK, footerClick);			mc.buttonMode = true;						var arr:Array = [mc, dataXML.footerIcon[currentLoadNum].@url] ;						iconArr.push(arr);						currentLoadNum++;						loadNav();					}						private function footerClick(e:MouseEvent){			var num:Number = Number(e.currentTarget.name.substring(3))			var keyword:String = iconArr[num][1];			if(keyword.substr(0, 4) == "http"){				//is linkout				navigateToURL(new URLRequest(keyword), "_blank");			} else {				Gaia.api.getPage("index/nav").content.siteNavCall(keyword);				trace("LINK SITE:"+keyword);			}					}					private function initLegal()		{			var legalContainer:Sprite = new Sprite();			privacyBut = new privacybutton();			legalBut = new legalbutton();			legalContainer.addChild(privacyBut);			legalContainer.addChild(legalBut);			legalBut.x = privacyBut.width + 20;						addChild(legalContainer);			legalContainer.x = 500;			legalContainer.y = 10;						privacyBut.addEventListener(MouseEvent.CLICK, privacyClick);			privacyBut.buttonMode = true;		}						private function legalClick(e:MouseEvent){			var url:String = dataXML.@legalurl;			navigateToURL(new URLRequest(url), "_blank");					}				private function privacyClick(e:MouseEvent){			var url:String = dataXML.@privacyurl;			navigateToURL(new URLRequest(url), "_blank")		}			}}